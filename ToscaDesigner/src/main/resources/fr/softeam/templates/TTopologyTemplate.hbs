metadata:
  targetNamespace: "{{getProperty this "targetNamespace"}}"
  name: "{{name}}"
{{imports this}}
topology_template:
  node_templates:
{{#ownedElement}}  
    {{name}}:
      type: {{type.name}}
      metadata:
        displayName: "{{displayName}}"
      {{#if ownedAttributes}}properties:{{/if}}
      {{#ownedAttribute}}
        {{name}}: "{{value}}"
      {{/ownedAttribute}}
      {{#unless (noStereotypeApplications this "TRequirement")}}requirements:{{/unless}}
      {{#each ownedElement}}{{#extension}}{{#eq name "TRequirement"}}
        - {{../name}}:
            node: {{getProperty ../this "node"}}
            relationship: {{relationship}}
            capability: {{getProperty ../this "capability"}}
       	{{/eq}}{{/extension}}{{/each}}
      {{#unless (noStereotypeApplications this "TDeploymentArtifact")}}artifacts:{{/unless}}
      {{#each ownedElement}}{{#extension}}{{#eq name "TDeploymentArtifact"}}
        {{../name}}:
          type: {{getProperty ../this "artifactType"}}
          deploy_path: {{getProperty ../this "Deploy_path"}}
          file: {{getProperty ../this "File"}}
        {{/eq}}{{/extension}}{{/each}}
{{/ownedElement}}
  relationship_templates:
{{#ownedElement}}{{#targetingEnd}}{{#association}}{{#extension}}{{#eq name "TRelationshipTemplate"}}
    {{../name}}:
      type: {{getProperty ../this "type"}}
{{/eq}}{{/extension}}{{/association}}{{/targetingEnd}}{{/ownedElement}}