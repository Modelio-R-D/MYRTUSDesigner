{{#unless (noStereotypeApplications this "Metadata")}}metadata:{{/unless}}
{{#each ownedAttribute}}{{#extension}}{{#eq name "Metadata"}}
  {{../name}}: "{{../value}}"
{{/eq}}{{/extension}}{{/each}}
{{imports this}}
topology_template:
  node_templates:
{{#ownedElement}}{{#extension}}{{#eq name "TNodeTemplate"}}  
    {{../name}}:
      type: {{getProperty ../this "nodeType"}}
      {{#unless (noStereotypeApplications ../this "Metadata")}}metadata:{{/unless}}
      {{#each ../ownedAttribute}}{{#extension}}{{#eq name "Metadata"}}
        {{../name}}: "{{../value}}"
      {{/eq}}{{/extension}}{{/each}}
      {{#if ../ownedAttribute}}properties:{{/if}}
      {{#each ../ownedAttribute}}{{#extension}}{{#unless name "Metadata"}}
        {{../name}}: "{{../value}}"
      {{/unless}}{{/extension}}{{/each}}
      {{#unless (noStereotypeApplications ../this "TRequirement")}}requirements:{{/unless}}
      {{#each ../ownedElement}}{{#extension}}{{#eq name "TRequirement"}}
        - {{../name}}:
            node: {{getProperty ../this "node"}}
            relationship: {{relationship}}
            capability: {{getProperty ../this "capability"}}
       	{{/eq}}{{/extension}}{{/each}}
      {{#unless (noStereotypeApplications ../this "TDeploymentArtifact")}}artifacts:{{/unless}}
      {{#each ../ownedElement}}{{#extension}}{{#eq name "TDeploymentArtifact"}}
        {{../name}}:
          type: {{getProperty ../this "artifactType"}}
          deploy_path: {{getProperty ../this "Deploy_path"}}
          file: {{getProperty ../this "File"}}
        {{/eq}}{{/extension}}{{/each}}
{{/eq}}{{/extension}}{{/ownedElement}}
  relationship_templates:
{{#ownedElement}}{{#targetingEnd}}{{#association}}{{#extension}}{{#eq name "TRelationshipTemplate"}}
    {{../name}}:
      type: {{getProperty ../this "type"}}
{{/eq}}{{/extension}}{{/association}}{{/targetingEnd}}{{/ownedElement}}